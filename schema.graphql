enum ProposalType {
  AllianceMotion
  Announcement
  UnscrupulousItem
  FellowshipReferendum
}

enum ProposalStatus {
  Noted
  Proposed
  Tabled
  Started
  Announced
  Passed
  NotPassed
  Cancelled
  Executed
  ExecutionFailed
  Used
  Invalid
  Missing
  Reaped
  Approved
  Disapproved
  Closed
  Awarded
  Added
  Rejected
  Retracted
  Slashed
  Active
  Removed
  Extended
  Claimed
  Unrequested
  Requested
  Submitted
  Killed
  Cleared
  Deciding
  ConfirmStarted
  ConfirmAborted
  Confirmed
  DecisionDepositPlaced
  TimedOut
  Opened
}

type MotionThreshold {
  value: Int!
}

enum ReferendumThresholdType {
  SuperMajorityApprove
  SuperMajorityAgainst
  SimpleMajority
}

type ReferendumThreshold {
  type: ReferendumThresholdType!
}

union Threshold = MotionThreshold | ReferendumThreshold

type Preimage @entity {
  id: ID!
  proposer: String
  hash: String! @index
  deposit: BigInt
  length: Int
  proposedCall: ProposedCall
  section: String
  method: String
  status: ProposalStatus!
  createdAtBlock: Int! @index
  createdAt: DateTime! @index
  updatedAtBlock: Int
  updatedAt: DateTime
}

type Proposal @entity {
  id: ID!
  type: ProposalType! @index
  hash: String @index
  index: Int @index
  proposer: String
  deposit: BigInt
  threshold: Threshold
  end: Int
  delay: Int
  curator: String
  payee: String
  reward: BigInt
  fee: BigInt
  bond: BigInt
  digest: String
  announcement: Announcements
  callData: ProposedCall
  description: String
  parentBountyIndex: Int
  proposalArguments: ProposedCall
  proposalArgumentHash: String
  voting: [Vote!] @derivedFrom(field: "proposal")
  preimage: Preimage
  status: ProposalStatus!
  statusHistory: [StatusHistory!] @derivedFrom(field: "proposal")
  trackNumber: Int
  origin: String
  enactmentAtBlock: Int
  enactmentAfterBlock: Int
  submittedAtBlock: Int
  submissionDeposit: SubmissionDeposit
  decisionDeposit: DecisionDeposit
  deciding: Deciding
  tally: Tally
  executeAtBlockNumber: Int
  executedAt: DateTime
  createdAtBlock: Int! @index
  createdAt: DateTime! @index
  endedAtBlock: Int
  endedAt: DateTime
  updatedAtBlock: Int @index
  updatedAt: DateTime @index
}

type DecisionDeposit {
  who: String
  amount: BigInt
}

type SubmissionDeposit {
  who: String
  amount: BigInt
}

type Deciding {
  since: Int
  confirming: Int
}

enum AnnouncementType {
  Account
  Website
  Announcement
}

type Announcements @entity {
  id: ID!
  hash: String! @index
  index: Int @index
  proposer: String @index
  type: AnnouncementType @index
  version: String
  codec: BigInt
  announcement: JSON
  digest: String
  cid: String
  proposal: Proposal
  code: BigInt
  isRemoved: Boolean
  status: ProposalStatus!
  statusHistory: [StatusHistory!] @derivedFrom(field: "announcement")
  createdAt: DateTime! @index
  createdAtBlock: Int! @index
  updatedAt: DateTime @index
  updatedAtBlock: Int @index
}

type Tally {
  ayes: BigInt
  nays: BigInt
  support: BigInt
  bareAyes: BigInt
}

type StatusHistory @entity {
  id: ID!
  proposal: Proposal
  announcement: Announcements
  status: ProposalStatus!
  block: Int!
  timestamp: DateTime!
}

type ProposedCall {
  section: String!
  method: String!
  args: JSON
  description: String!
}

enum VoteDecision {
  yes
  no
  abstain
  split
  splitAbstain
}

type StandardVoteBalance {
  value: BigInt
}

type SplitVoteBalance {
  aye: BigInt
  nay: BigInt
  abstain: BigInt
}

union VoteBalance = StandardVoteBalance | SplitVoteBalance

enum VoteType {
  AllianceMotion
  Fellowship
  Referendum
}

type Vote @entity {
  id: ID!
  voter: String
  proposalId: ID!
  proposalIndex: Int! @index
  proposal: Proposal!
  blockNumber: Int! @index
  timestamp: DateTime! @index
  decision: VoteDecision
  balance: VoteBalance
  lockPeriod: Int
  type: VoteType
}